# i18n Files ({component}.i18n.ts)

## Overview

Internationalization (i18n) files contain translatable message definitions for
components using react-intl. These files ensure consistent, accessible, and
translatable user interface text across all supported locales.

## Purpose

i18n files serve to:

- Define translatable strings for accessibility labels (aria-label,
  aria-description)
- Provide user-facing text that needs localization
- Ensure consistent message ID structure across the design system
- Support professional translation workflows via Transifex

## File Structure

### Location

```
src/components/{component-name}/{component-name}.i18n.ts
```

### Basic Template

```typescript
import { defineMessages } from "react-intl";

export const messages = defineMessages({
  dismiss: {
    id: "Nimbus.Alert.dismiss",
    description: "aria-label for dismiss button in alert",
    defaultMessage: "Dismiss",
  },
  // Additional messages...
});

export default messages;
```

## Message ID Convention

All message IDs must follow the hierarchical naming pattern:

```
Nimbus.{ComponentName}.{messageKey}
```

### Examples

- `Nimbus.Alert.dismiss`
- `Nimbus.DatePicker.clearInput`
- `Nimbus.NumberInput.increment`
- `Nimbus.PasswordInput.show`

For nested or complex components:

```
Nimbus.{ComponentName}.{SubComponent}.{messageKey}
```

Example: `Nimbus.DatePicker.Time.enterTimeHour`

## Message Properties

Each message must include:

- **id**: Unique identifier following naming convention
- **description**: Developer-facing context (appears in translation files)
- **defaultMessage**: English fallback text

```typescript
{
  id: "Nimbus.Select.clearSelection",
  description: "aria-label for select clear button",
  defaultMessage: "Clear selection",
}
```

## Component Integration

### Import Pattern

```typescript
import { useIntl } from "react-intl";
import { messages } from "../{component}.i18n";
```

### Usage in Components

```typescript
export const AlertDismissButton = (props: AlertDismissButtonProps) => {
  const intl = useIntl();

  return (
    <IconButton
      aria-label={intl.formatMessage(messages.dismiss)}
      {...props}
    >
      <Clear role="img" />
    </IconButton>
  );
};
```

### With Dynamic Values

```typescript
const label = intl.formatMessage(messages.itemsSelected, {
  count: selectedItems.length,
});
```

## Common Use Cases

### 1. Accessibility Labels

Primary use case for i18n in Nimbus:

```typescript
export const messages = defineMessages({
  increment: {
    id: "Nimbus.NumberInput.increment",
    description: "aria-label for the increment button in number input",
    defaultMessage: "Increment",
  },
  decrement: {
    id: "Nimbus.NumberInput.decrement",
    description: "aria-label for the decrement button in number input",
    defaultMessage: "Decrement",
  },
});
```

### 2. Tooltip Content

```typescript
export const messages = defineMessages({
  showPassword: {
    id: "Nimbus.PasswordInput.show",
    description: "aria-label & tooltip for show password button",
    defaultMessage: "Show password",
  },
});
```

### 3. Placeholder Text

```typescript
export const messages = defineMessages({
  enterTime: {
    id: "Nimbus.DatePicker.Time.enterTime",
    description: "aria-label for time input field in date picker",
    defaultMessage: "Enter time",
  },
});
```

### 4. Loading States

```typescript
export const messages = defineMessages({
  loading: {
    id: "Nimbus.LoadingSpinner.default",
    description: "Default loading message for loading spinners",
    defaultMessage: "Loading data",
  },
});
```

## React Aria Integration

When using React Aria hooks, pass localized labels:

```typescript
const intl = useIntl();

const ariaProps = {
  ...functionalProps,
  incrementAriaLabel: intl.formatMessage(messages.increment),
  decrementAriaLabel: intl.formatMessage(messages.decrement),
};

const { inputProps, incrementButtonProps, decrementButtonProps } =
  useNumberField(ariaProps, state, ref);
```

## Translation Workflow

### 1. Source Files

Located in `packages/i18n/data/`:

```json
{
  "Nimbus.Alert.dismiss": {
    "developer_comment": "aria-label for dismiss button in alert",
    "string": "Dismiss"
  }
}
```

### 2. Compiled Files

Generated in `packages/i18n/compiled-data/`:

```json
{
  "Nimbus.Alert.dismiss": [
    {
      "type": 0,
      "value": "Dismiss"
    }
  ]
}
```

### 3. Build Process

```bash
# Compile translation files
pnpm dlx @formatjs/cli compile-folder --format=transifex --ast data compiled-data
```

## Supported Locales

Current support includes:

- `en` - English (default)
- `de` - German
- `es` - Spanish
- `fr-FR` - French (France)
- `pt-BR` - Portuguese (Brazil)

## Best Practices

### ✅ DO

- Use i18n for ALL user-facing text that needs translation
- Keep messages concise and clear
- Provide meaningful descriptions for translators
- Use proper grammar and punctuation in default messages
- Test with different locales to ensure proper text rendering

### Guidelines to Follow

- Always internationalize aria-labels and user-facing text
- Use clear, user-friendly language in default messages
- Keep translated strings intact (avoid concatenation)
- Design layouts to accommodate different text lengths across languages
- Use i18n only for user-facing content, not internal/debug messages


## Testing

### With Storybook

Storybook includes locale switching in the toolbar:

```typescript
// .storybook/decorators/intl.tsx
export const WithIntlDecorator: Decorator = (Story, context) => {
  const locale = context.globals.locale || "en";
  // ... locale handling
};
```

### Unit Testing

Mock intl in tests:

```typescript
const mockIntl = {
  formatMessage: ({ defaultMessage }) => defaultMessage,
};
```

## Examples from Codebase

### Alert Component

`packages/nimbus/src/components/alert/alert.i18n.ts`:

```typescript
import { defineMessages } from "react-intl";

export const messages = defineMessages({
  dismiss: {
    id: "Nimbus.Alert.dismiss",
    description: "aria-label for dismiss button in alert",
    defaultMessage: "Dismiss",
  },
});
```

### Number Input Component

`packages/nimbus/src/components/number-input/number-input.i18n.ts`:

```typescript
import { defineMessages } from "react-intl";

export const messages = defineMessages({
  increment: {
    id: "Nimbus.NumberInput.increment",
    description: "aria-label for the increment button in number input",
    defaultMessage: "Increment",
  },
  decrement: {
    id: "Nimbus.NumberInput.decrement",
    description: "aria-label for the decrement button in number input",
    defaultMessage: "Decrement",
  },
});

export default messages;
```

## Validation Checklist

When creating or reviewing i18n files:

- [ ] File follows naming convention: `{component}.i18n.ts`
- [ ] All message IDs follow pattern: `Nimbus.{Component}.{key}`
- [ ] Each message has id, description, and defaultMessage
- [ ] Descriptions clearly explain context for translators
- [ ] Default messages use proper grammar and punctuation
- [ ] Component imports and uses intl correctly
- [ ] All user-facing text is internationalized
- [ ] aria-labels are properly localized
- [ ] No hardcoded strings in component
- [ ] Messages are exported as default
- [ ] File is imported in component index barrel export

## Related Documentation

- [Main Component Guidelines](./main-component.md) - Component implementation
  with i18n
- [Accessibility Guidelines](./architecture-decisions.md) - Accessibility
  requirements
- [React Aria Integration](./architecture-decisions.md#react-aria-requirements) -
  Using React Aria with i18n

---

[← Back to Component Guidelines](../component-guidelines.md)
